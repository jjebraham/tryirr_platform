{% extends "core/base.html" %}
{% load i18n socialaccount %}

{% block title %}{% trans "Log In" %} | Peerexo.com{% endblock %}

{% block content %}
<div class="max-w-md mx-auto">
  <h1 class="text-3xl font-extrabold text-center mb-6">
    {% trans "Login" %}
  </h1>

  <form method="post" action="{% url 'account_login' %}" class="space-y-6 bg-white p-8 rounded-lg shadow">
    {% csrf_token %}
    {% if form.non_field_errors %}
      <div class="text-red-600">{{ form.non_field_errors }}</div>
    {% endif %}

    <div>
      <label for="id_login" class="block text-sm font-medium text-gray-700">
        {% trans "Username or Email" %}
      </label>
      <input id="id_login"
             name="login"
             type="text"
             required
             placeholder="{% trans 'Username or email' %}"
             class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-full
                    focus:ring-blue-500 focus:border-blue-500" />
      {{ form.login.errors }}
    </div>

    <div>
      <label for="id_password" class="block text-sm font-medium text-gray-700">
        {% trans "Password" %}
      </label>
      <div class="relative">
        <input id="id_password"
               name="password"
               type="password"
               required
               placeholder="••••••••"
               class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-full
                      focus:ring-blue-500 focus:border-blue-500 pr-10" />
        <button type="button"
                class="absolute inset-y-0 right-3 flex items-center text-gray-500 toggle-password"
                data-target="id_password">
          <!-- Eye icon -->
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none"
               viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 
                     8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 
                     7-4.477 0-8.268-2.943-9.542-7z" />
          </svg>
        </button>
      </div>
      {{ form.password.errors }}
    </div>

    <button type="submit"
            class="w-full py-3 bg-black text-white rounded-full hover:bg-gray-800">
      {% trans "Login" %}
    </button>
  </form>

  <!-- “Don’t have an account?” + signup link -->
  <div class="mt-4 text-center text-sm text-gray-600">
    {% trans "Don't have an account?" %}
    <a href="{% url 'account_signup' %}" class="font-medium text-black hover:underline">
      {% trans "Sign up" %}
    </a>
  </div>

  <!-- OR divider -->
  <div class="relative my-6">
    <div class="border-t border-gray-300"></div>
    <div class="absolute inset-x-0 top-1/2 transform -translate-y-1/2 bg-gray-100 px-4 text-gray-500">
      OR
    </div>
  </div>

  <!-- Google login button -->
  <div>
    <a href="{% provider_login_url 'google' process='login' %}"
       class="w-full flex items-center justify-center py-3 px-4 border border-gray-300
              rounded-full hover:bg-gray-50">
      <img src="https://www.svgrepo.com/show/355037/google.svg"
           alt="Google"
           class="w-5 h-5 mr-2" />
      {% trans "Continue with Google" %}
    </a>
  </div>
</div>

<script>
  // Toggle show/hide password
  document.querySelectorAll('.toggle-password').forEach(btn =>
    btn.addEventListener('click', () => {
      const tgt = document.getElementById(btn.dataset.target);
      tgt.type = tgt.type === 'password' ? 'text' : 'password';
    })
  );
</script>
{% endblock %}

