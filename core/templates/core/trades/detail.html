{% extends "core/base.html" %}
{% block title %}Trade #{{ trade.pk }}{% endblock %}
{% block content %}
<h1 class="text-2xl font-bold mb-4">Trade Details</h1>
<div class="mb-4 p-4 bg-white dark:bg-gray-800 rounded">
  <p><strong>Offer:</strong> {{ trade.offer }}</p>
  <p><strong>Status:</strong> {{ trade.get_status_display }}</p>
  <p><strong>Buyer:</strong> {{ trade.buyer }}</p>
  <p><strong>Seller:</strong> {{ trade.seller }}</p>
  <p><strong>Amount:</strong> {{ trade.amount }}</p>
  <p><strong>Rate:</strong> {{ trade.rate }}</p>
</div>
{% if can_fund or can_release %}
<form method="post" class="mb-4">
  {% csrf_token %}
  {% if can_fund %}
    <button name="fund" class="px-4 py-2 bg-yellow-600 text-white rounded">Mark as funded</button>
  {% endif %}
  {% if can_release %}
    <button name="release" class="px-4 py-2 bg-green-600 text-white rounded">Release funds</button>
  {% endif %}
</form>
{% endif %}
<div class="bg-white dark:bg-gray-800 p-4 rounded">
  <h2 class="font-semibold mb-2">Chat</h2>
  <div class="space-y-2 mb-4 max-h-64 overflow-y-auto">
    {% for msg in messages %}
      <div><strong>{{ msg.sender }}:</strong> {{ msg.message }} <span class="text-xs text-gray-500">{{ msg.timestamp|date:"H:i" }}</span></div>
    {% empty %}
      <p>No messages yet.</p>
    {% endfor %}
  </div>
  <form method="post">
    {% csrf_token %}
    {{ form.message }}
    <button type="submit" class="mt-2 px-4 py-2 bg-blue-600 text-white rounded">Send</button>
  </form>
</div>
{% endblock %}
